# 变更日志

本文档记录购物系统的所有重要变更和版本历史。

## [2.0.0] - 2025-11-17

### 新增功能

#### 商品管理模块（管理员功能）
- 实现`Item`商品类，支持ID、名称、类别、价格、描述、库存等字段
- 实现`ItemManager`商品管理器
  - 双重存储结构：vector存储所有商品 + map按类别索引
  - 动态表头支持，可由管理员自定义字段
  - CSV文件读写功能
  - 商品增删改查功能
  - 表格化显示所有商品
- 管理员可添加新商品
  - 自动生成或手动指定商品ID
  - 支持所有字段输入和验证
  - 添加成功后自动显示商品列表
- 管理员可修改商品信息
  - 支持逐字段修改
  - 每次修改后自动显示更新的商品列表
- 管理员可删除商品
  - 删除前确认提示
  - 删除成功后显示更新的商品列表

#### 商品搜索模块（用户功能）
- 实现`ItemSearcher`商品搜索类
- **精确搜索功能**
  - 按商品名称精确匹配
  - 按商品类别精确匹配
  - 按价格范围搜索
- **模糊搜索功能**
  - 使用Levenshtein编辑距离算法
  - 计算字符串相似度（0-1之间）
  - 支持部分匹配（关键字包含）
  - 搜索商品名称和描述
  - 结果按相似度降序排序
  - 显示相似度百分比
- **智能搜索策略**
  - 优先进行精确搜索
  - 无结果时自动切换模糊搜索
  - 降低阈值以获得更多相关结果
- 搜索结果表格化显示

#### 数据文件增强
- items.csv新增字段
  - category（商品类别）
  - description（商品描述）
- 预置10个商品示例数据
  - 手机类（4个）
  - 电脑类（2个）
  - 平板类（1个）
  - 耳机类（2个）
  - 游戏机类（1个）

#### 用户界面增强
- **管理员菜单扩展**
  - 添加"查看所有商品信息"选项
  - 添加"添加商品"选项
  - 添加"修改商品"选项
  - 添加"删除商品"选项
- **顾客菜单扩展**
  - 添加"搜索商品"选项
  - 支持关键字搜索
  - 显示搜索结果和相似度

### 技术实现

#### 设计模式和算法
- **双重索引结构**
  - `vector<Item>`：顺序存储所有商品
  - `map<category, vector<Item>>`：类别索引，快速按类别查询
- **Levenshtein算法**
  - 动态规划实现编辑距离计算
  - 时间复杂度：O(m*n)，m和n为字符串长度
  - 相似度公式：1 - (距离 / max(len1, len2))
- **增强的模糊匹配**
  - 编辑距离相似度
  - 子串包含检测
  - 描述内容匹配
  - 多重相似度综合评分

#### 代码质量改进
- 完整的Doxygen注释（新增约2000行代码和注释）
- 所有新类和函数都有详细文档
- 注释量保持在40%以上
- 模块化设计，职责明确

#### 文件结构更新
```
Include/ItemManage/
├── Item.h              # 商品类定义
├── ItemManager.h       # 商品管理器
└── ItemSearcher.h      # 商品搜索器

Src/ItemManage/
├── Item.cpp            # 商品类实现
├── ItemManager.cpp     # 商品管理器实现
└── ItemSearcher.cpp    # 商品搜索器实现（含Levenshtein算法）
```

### 功能对比

| 功能模块 | v1.0.0 | v2.0.0 |
|---------|--------|--------|
| 用户管理 | ✅ | ✅ |
| 登录系统 | ✅ | ✅ |
| 商品查看 | 基础CSV读取 | 完整商品管理器 |
| 商品管理 | ❌ | ✅（增删改） |
| 商品搜索 | ❌ | ✅（精确+模糊） |
| 双重索引 | ❌ | ✅ |
| 动态表头 | ❌ | ✅ |
| 模糊算法 | ❌ | ✅（Levenshtein） |

### 代码统计（v2.0.0）
- 新增代码文件：6个（3个.h + 3个.cpp）
- 新增代码行数：约1500行
- 新增注释行数：约700行
- 总代码量：约3000行
- 总类数：10个

### 已知特性
- 支持扩展字段（通过extraFields映射）
- 管理员可动态添加/删除表头字段
- 搜索相似度阈值可调整（默认0.4-0.5）
- 每次修改商品后自动显示完整列表

### 性能特点
- 类别索引查询：O(1)平均时间复杂度
- 模糊搜索：O(n*m*k)，n为商品数，m为关键字长度，k为商品名称平均长度
- 适合中小规模商品数据（<10000件）

## [1.0.0] - 2025-11-15

### 新增功能

#### 配置管理模块
- 实现`Config`类，支持读取YAML格式配置文件
- 提供单例模式访问全局配置
- 支持管理员账号配置
- 支持数据文件路径配置

#### 用户管理模块
- 实现`User`基类，定义用户通用接口
- 实现`Customer`顾客类，支持用户名、密码、手机号三个属性
- 实现`Admin`管理员类
- 实现`UserManager`用户管理器
  - CSV文件读写功能
  - 用户增删改查功能
  - 密码修改功能
  - 用户名唯一性检查

#### 登录系统模块
- 实现`LoginSystem`登录系统类
- 管理员登录功能（基于配置文件）
- 顾客登录功能（基于CSV数据文件）
- 顾客注册功能
  - 用户名唯一性验证
  - 输入合法性验证
  - 自动保存到数据文件
- 密码修改功能
  - 旧密码验证
  - 新密码确认
  - 自动更新数据文件
- 会话管理（登录/登出）

#### 主程序
- 实现交互式控制台界面
- 根据用户角色显示不同菜单
  - 主菜单（未登录）
  - 顾客菜单（顾客登录后）
  - 管理员菜单（管理员登录后）
- 商品信息查看功能（支持未登录访问）
- 管理员查看所有顾客信息功能
- 输入验证和错误处理

#### 构建系统
- 创建CMakeLists.txt配置文件
- 支持MinGW编译器
- 自动收集源文件
- 自动复制配置文件到输出目录
- 设置C++17标准

#### 数据文件
- 创建`config.yaml`配置文件
- 创建`items.csv`商品数据示例文件
- 定义CSV文件格式规范

#### 文档
- 创建README.md项目说明文档
  - 项目简介
  - 功能特性
  - 技术架构
  - 编译和运行指南
  - 使用说明
  - 代码规范
- 创建ChangeLog.md变更日志文档
- 创建.gitignore文件

### 技术实现

#### 设计模式
- 单例模式：Config配置管理器
- 继承和多态：User基类及其子类
- 智能指针：使用std::shared_ptr管理对象生命周期

#### 代码质量
- 完整的Doxygen风格注释
- 注释量达到代码量的1/3以上
- 符合面向对象设计原则
- 高内聚、低耦合的模块设计

#### 文件结构
- 标准的C++项目结构
- 头文件和源文件分离
- 按功能模块组织代码

### 已知限制

1. 密码未加密存储（明文存储在CSV文件中）
2. 商品管理功能仅支持查看，不支持添加/修改/删除
3. 未实现购物车和订单功能
4. 未实现数据备份和恢复功能
5. 控制台界面较为简单，无图形界面

### 依赖项

- C++17标准库
- CMake 3.15+
- MinGW编译器（Windows平台）

### 配置要求

- 操作系统：Windows
- 编译器：支持C++17的MinGW
- 内存：至少64MB可用内存
- 磁盘：至少10MB可用空间

## 版本规划

### [1.1.0] - 计划中
- 添加购物车功能
- 添加订单管理功能
- 实现密码加密存储
- 添加数据备份功能

### [1.2.0] - 计划中
- 商品管理功能（管理员添加/修改/删除商品）
- 库存管理功能
- 销售统计功能
- 日志系统

### [2.0.0] - 计划中
- 图形用户界面（GUI）
- 数据库支持（替代CSV文件）
- 多用户并发支持
- 网络功能支持

## 版本编号说明

本项目采用语义化版本号（Semantic Versioning）：

- **主版本号**：不兼容的API修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

格式：主版本号.次版本号.修订号（例如：1.0.0）

## 贡献者

- Shopping System Development Team

## 反馈

如有问题或建议，请联系开发团队。

---

*最后更新：2025年11月15日*
